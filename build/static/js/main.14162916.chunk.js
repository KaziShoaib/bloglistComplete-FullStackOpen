(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{19:function(e,t,n){e.exports=n(42)},42:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),u=n(17),c=n.n(u),l=n(18),o=n(7),i=n(1),s=n.n(i),p=n(4),d=n(2),m=(n(6),function(e){var t=e.blog,n=e.addLike,u=e.deleteBlog,c=Object(a.useState)(!1),l=Object(d.a)(c,2),o=l[0],i=l[1],s={display:o?"none":""},p={display:o?"":"none"},m=function(){return i(!o)},f={display:"none"},b=window.localStorage.getItem("loggedBlogappUser");if(b){var v=JSON.parse(b);t.user.username===v.username&&(f={display:""})}return r.a.createElement("div",{className:"blog"},r.a.createElement("div",{style:s,className:"blogSummary"},r.a.createElement("p",null,t.title," ",t.author," ",r.a.createElement("button",{onClick:m,className:"view-button"},"view"))),r.a.createElement("div",{style:p,className:"blogDetail"},r.a.createElement("p",null,t.title," ",t.author," ",r.a.createElement("button",{onClick:m},"hide")),r.a.createElement("p",null,r.a.createElement("a",{href:t.url},t.url)),r.a.createElement("p",null,"Likes ",r.a.createElement("span",{className:"like-count"},t.likes)," ",r.a.createElement("button",{onClick:n,className:"like-button"},"Like")),r.a.createElement("p",null,t.user.name),r.a.createElement("button",{style:f,className:"delete-button",onClick:function(){return e=t.id,void(window.confirm("Do you want to delete ".concat(t.title,"?"))&&u(e));var e}},"Delete")))}),f=n(5),b=n.n(f),v=null,g={getAll:function(){var e=Object(p.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setToken:function(e){v="bearer ".concat(e)},create:function(){var e=Object(p.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:v}},e.next=3,b.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(p.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.put("".concat("/api/blogs","/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(p.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:v}},e.next=3,b.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},h=function(e){var t=e.successMessage,n=e.errorMessage;return t?r.a.createElement("div",{className:"success"},t):n?r.a.createElement("div",{className:"error"},n):null},E={login:function(){var e=Object(p.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},k=function(e){var t=e.handleLogin,n=Object(a.useState)(""),u=Object(d.a)(n,2),c=u[0],l=u[1],o=Object(a.useState)(""),i=Object(d.a)(o,2),s=i[0],p=i[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({username:c,password:s}),l(""),p("")}},r.a.createElement("div",null,"Username:",r.a.createElement("input",{name:"Username",value:c,type:"text",id:"username",onChange:function(e){return l(e.target.value)}})),r.a.createElement("div",null,"Password:",r.a.createElement("input",{name:"Password",value:s,type:"password",id:"password",onChange:function(e){return p(e.target.value)}})),r.a.createElement("button",{id:"login-button",type:"submit"},"Log in")))},w=r.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),u=Object(d.a)(n,2),c=u[0],l=u[1],o={display:c?"none":""},i={display:c?"":"none"},s=function(){l(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisible:s}})),r.a.createElement("div",null,r.a.createElement("div",{style:o},r.a.createElement("button",{onClick:s},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement("button",{onClick:s},"Cancel")))}));w.displayName="Togglable";var O=w,j=function(e){var t=e.addBlog,n=Object(a.useState)(""),u=Object(d.a)(n,2),c=u[0],l=u[1],o=Object(a.useState)(""),i=Object(d.a)(o,2),s=i[0],p=i[1],m=Object(a.useState)(""),f=Object(d.a)(m,2),b=f[0],v=f[1];return r.a.createElement("div",null,r.a.createElement("h2",null,"Add a new blog"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:s,url:b}),l(""),p(""),v("")}},r.a.createElement("div",null,"Title:",r.a.createElement("input",{name:"Title",id:"title",type:"text",value:c,onChange:function(e){return l(e.target.value)}})),r.a.createElement("div",null,"Author:",r.a.createElement("input",{name:"Author",id:"author",type:"text",value:s,onChange:function(e){return p(e.target.value)}})),r.a.createElement("div",null,"URL:",r.a.createElement("input",{name:"URL",id:"url",type:"text",value:b,onChange:function(e){return v(e.target.value)}})),r.a.createElement("button",{id:"submit-blog-button",type:"submit"},"create")))},y=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],u=t[1],c=Object(a.useState)(null),i=Object(d.a)(c,2),f=i[0],b=i[1],v=Object(a.useState)(null),w=Object(d.a)(v,2),y=w[0],x=w[1],S=Object(a.useState)(null),C=Object(d.a)(S,2),L=C[0],B=C[1],N=Object(a.useRef)();Object(a.useEffect)((function(){g.getAll().then((function(e){return u(e)}))}),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);B(t),g.setToken(t.token)}}),[]);var T=function(){var e=Object(p.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(n)),B(n),g.setToken(n.token),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),x("Invalid username or password"),setTimeout((function(){x(null)}),5e3);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(p.a)(s.a.mark((function e(t){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return N.current.toggleVisible(),e.prev=1,e.next=4,g.create(t);case 4:a=e.sent,r=Object(o.a)({},a,{user:{username:L.username,name:L.name,id:a.user.toString()}}),u(n.concat(r)),b("a new blog ".concat(a.title," by ").concat(a.author," added")),setTimeout((function(){b(null)}),5e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),x(e.t0.response.data.error),setTimeout((function(){x(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(p.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.deleteBlog(t);case 3:u(n.filter((function(e){return e.id!==t}))),b("the blog has been successfully deleted"),setTimeout((function(){b(null)}),5e3),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),x(e.t0.data.error.message),setTimeout((function(){x(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(p.a)(s.a.mark((function e(t){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.find((function(e){return e.id===t})),r={likes:a.likes+1},e.prev=2,e.next=5,g.update(t,r);case 5:u(n.map((function(e){return e.id===t?Object(o.a)({},e,{likes:e.likes+1}):e}))),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(2),x("Blog ".concat(a.title," has been deleted")),setTimeout((function(){x(null)}),5e3),u(n.filter((function(e){return e.id!==t})));case 13:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement(h,{successMessage:f,errorMessage:y}),null===L?r.a.createElement(k,{handleLogin:T}):r.a.createElement("div",null,r.a.createElement("h2",null,L.name," logged in"),r.a.createElement("button",{onClick:function(){window.localStorage.removeItem("loggedBlogappUser"),g.setToken(null),B(null)}},"Log out"),r.a.createElement(O,{buttonLabel:"add a blog",ref:N},r.a.createElement(j,{addBlog:U})),r.a.createElement("h2",null,"BLOGS"),r.a.createElement("button",{onClick:function(){var e=Object(l.a)(n).sort((function(e,t){return t.likes-e.likes}));u(e)},id:"sort-button"},"Sort by likes"),n.map((function(e){return r.a.createElement(m,{key:e.id,blog:e,addLike:function(){return I(e.id)},deleteBlog:A})}))))};c.a.render(r.a.createElement(y,null),document.getElementById("root"))},6:function(e,t,n){}},[[19,1,2]]]);
//# sourceMappingURL=main.14162916.chunk.js.map